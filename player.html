<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FilmLaku21 â€” Player</title>
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>
<header>
  <div class="top-header">
    <div class="logo"><a href="index.html" style="color:inherit;">FilmLaku21</a></div>
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="Cari Film..." />
      <div id="searchResults" class="search-results"></div>
    </div>
  </div>

  <nav class="nav-categories">
    <a href="index.html">ğŸ  Beranda</a>
    <a href="index.html?kategori=Drama">ğŸ­ Drama</a>
    <a href="index.html?kategori=Romance">ğŸ’– Romance</a>
    <a href="index.html?kategori=Action">ğŸ”¥ Action</a>
  </nav>
</header>

<main>
  <div class="container" id="player-container"></div>
</main>

<footer>
  <p>Â© 2025 FilmLaku21. Semua Hak Dilindungi.</p>
</footer>

<script src="assets/js/films.js"></script>
<script src="assets/js/utils.js"></script>
<script>
function loadServer(url) {
  const player = document.getElementById("videoPlayer");
  if (player) player.src = url;
}

function loadPlayer() {
  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");
  const film = films[id];

  if (!id || !film) {
    document.getElementById("player-container").innerHTML = `<p>Film tidak ditemukan.</p>`;
    return;
  }

  document.getElementById("player-container").innerHTML = `
    <h2>${film.title}</h2>
    <div class="server-list" style="margin-bottom:12px;">
      <button onclick="loadServer('${film.video}')">Server 1</button>
      <button onclick="loadServer('https://www.youtube.com/embed/tgbNymZ7vqY')">Server 2</button>
      <button onclick="loadServer('https://www.youtube.com/embed/oHg5SJYRHA0')">Server 3</button>
    </div>
    <iframe id="videoPlayer" src="${film.video}" allowfullscreen></iframe>
    ${renderFilmRecommendations(film.rekomendasi)}
  `;
}

/* Init */
loadPlayer();
initLiveSearch();

/* Local quick-search fallback inside player page */
document.getElementById("searchInput").addEventListener("input", (e) => {
  const q = e.target.value.trim();
  if (!q) {
    loadPlayer();
    return;
  }
  const ids = Object.keys(films).filter(k => films[k].title.toLowerCase().includes(q.toLowerCase()));
  document.getElementById("player-container").innerHTML = `<h2>Hasil Pencarian</h2>${renderFilmGrid(ids)}`;
});
</script>
</body>
</html>
